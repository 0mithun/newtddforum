(window.webpackJsonp=window.webpackJsonp||[]).push([[4,8],{"Aoi+":function(e,t,n){var a=n("W1YS");"string"==typeof a&&(a=[[e.i,a,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n("aET+")(a,i);a.locals&&(e.exports=a.locals)},EHFx:function(e,t,n){"use strict";n.r(t);var a={props:["dataSet"],data:function(){return{page:1,prevUrl:!1,nextUrl:!1}},watch:{dataSet:function(){this.page=this.dataSet.current_page,this.prevUrl=this.dataSet.prev_page_url,this.nextUrl=this.dataSet.next_page_url},page:function(){this.broadcast().updateUrl()}},computed:{shouldPaginate:function(){return!!this.prevUrl||!!this.nextUrl}},methods:{broadcast:function(){return this.$emit("changed",this.page)},updateUrl:function(){history.pushState(null,null,"?page="+this.page)}}},i=(n("S0md"),n("KHd+")),s=Object(i.a)(a,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.shouldPaginate?n("ul",{staticClass:"pagination"},[n("li",{directives:[{name:"show",rawName:"v-show",value:e.prevUrl,expression:"prevUrl"}]},[n("a",{attrs:{href:"#","aria-label":"Previous",rel:"prev"},on:{click:function(t){t.preventDefault(),e.page--}}},[n("span",{attrs:{"aria-hidden":"true"}},[e._v("« Previous")])])]),e._v(" "),n("li",{directives:[{name:"show",rawName:"v-show",value:e.nextUrl,expression:"nextUrl"}]},[n("a",{attrs:{href:"#","aria-label":"Next",rel:"next"},on:{click:function(t){t.preventDefault(),e.page++}}},[n("span",{attrs:{"aria-hidden":"true"}},[e._v("Next »")])])])]):e._e()}),[],!1,null,"a9b68ee6",null);t.default=s.exports},OP0S:function(e,t,n){var a=n("QMla");"string"==typeof a&&(a=[[e.i,a,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n("aET+")(a,i);a.locals&&(e.exports=a.locals)},OvF0:function(e,t,n){(e.exports=n("I1BE")(!1)).push([e.i,"\n.comment-body[data-v-e944b2ae] {\r\n  resize: vertical !important;\n}\n.add-new-reply[data-v-e944b2ae] {\r\n  padding: 30px 15px;\n}\n.comment-heading[data-v-e944b2ae] {\r\n  color: black;\r\n  margin-top: 0;\r\n  margin-bottom: 20px;\n}\r\n",""])},QMla:function(e,t,n){(e.exports=n("I1BE")(!1)).push([e.i,".pagination[data-v-a9b68ee6] {\n  margin: 20px 10px;\n}",""])},"S/gD":function(e,t,n){"use strict";n.r(t);n("TiIQ"),n("bKju");var a={props:["reply"],components:{NestedReplies:function(){return n.e(28).then(n.bind(null,"RKNe"))}},data:function(){return{editing:!1,id:this.reply.id,body:this.reply.body,editBody:this.reply.body,replies:[],replies_count:this.reply.reply_count,showNested:!1,addNested:!1,nestedbody:"",showLoadMore:!0}},created:function(){var e=this;eventBus.$on("nested_delete-"+this.reply.id,(function(t){var n=e.replies.filter((function(e){return e.id!=t}));e.replies=n,e.replies_count=e.replies_count-1}))},computed:{ago:function(){return moment(this.reply.created_at,"YYYY-MM-DD HH:mm:ss").fromNow()+"..."},signedIn:function(){return!!window.App.user},redirectToLogin:function(){return"/redirect-to?page="+location.pathname}},methods:{toggleNestedReplies:function(){this.showNested?this.showNested=!1:(this.loadNestedReply(),this.showNested=!0)},addReplySuggest:function(){$("#bodyedit-"+this.reply.id).atwho({at:"@",delay:750,callbacks:{remoteFilter:function(e,t){$.getJSON("/api/users",{name:e},(function(e){t(e)}))}}}),$("#addNested-"+this.reply.id).atwho({at:"@",delay:750,callbacks:{remoteFilter:function(e,t){$.getJSON("/api/users",{name:e},(function(e){t(e)}))}}})},addNestedReplySuggest:function(){$("#addNested-"+this.reply.id).atwho({at:"@",delay:750,callbacks:{remoteFilter:function(e,t){$.getJSON("/api/users",{name:e},(function(e){t(e)}))}}})},loadNestedReply:function(){var e=this,t="/replies/".concat(this.reply.id,"/load-reply");axios.get(t).then((function(t){var n=t.data;e.replies=n}))},update:function(){axios.patch("/replies/"+this.id,{body:this.editBody}).catch((function(e){flash(e.response.data,"danger")})),this.body=this.editBody,this.editing=!1,flash("Updated!")},destroy:function(){this.replies_count>0?flash("Your reply has many replies.","danger"):confirm("Are you sure delete this reply")&&(axios.delete("/replies/"+this.id),this.$emit("deleted",this.id),eventBus.$emit("deleteReply",this.id),flash("Your reply has been deleted."))},addNestedReply:function(){var e=this,t="/replies/".concat(this.reply.id,"/new-reply");axios.post(t,{body:this.nestedbody}).catch((function(e){flash(e.response.data,"danger")})).then((function(t){var n=t.data;e.nestedbody="",e.replies.push(n),e.replies_count=e.replies_count+1,e.addNested=!1,e.showLoadMore=!0,eventBus.$emit("addNestedReplies-"+e.reply.thread_id),flash("Your reply has been posted.")}))}}},i=(n("z/Db"),n("KHd+")),s=Object(i.a)(a,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"single-reply",attrs:{id:"reply-"+e.id}},[n("div",{staticClass:"row reply-heading"},[n("div",{staticClass:"col-md-8"},[n("div",{staticClass:"thread_creator"},[n("a",{staticClass:"creator_name",attrs:{href:e.reply.ownerProfileUrl}},[n("img",{staticClass:"avatar-photo",attrs:{src:e.reply.owner.profileAvatarPath,alt:e.reply.owner.name,width:"25",height:"25"}}),e._v(" "),n("user-online",{attrs:{user:e.reply.owner}}),e._v("\n          "+e._s(e.reply.owner.name)+"\n        ")],1),e._v(" "),n("span",{staticClass:"reply_created_at",domProps:{textContent:e._s(e.ago)}})])]),e._v(" "),e.signedIn?n("div",{staticClass:"col-md-4 reply-edit-delete-btn"},[n("div",{staticClass:"form-g"},[!e.authorize("owns",e.reply)&&!e.authorize("isAdmin")||e.authorize("isBan")?e._e():n("button",{staticClass:"btn btn-xs btn-danger",on:{click:e.destroy}},[e._v("\n          Delete\n        ")]),e._v(" "),e.authorize("owns",e.reply)&&!e.authorize("isBan")?n("button",{staticClass:"btn btn-xs btn-primary",on:{click:function(t){e.editing=!0}}},[e._v("\n          Edit\n        ")]):e._e()])]):e._e()]),e._v(" "),n("div",{staticClass:"row reply-body"},[n("div",{staticClass:"col-md-12"},[n("div",{staticClass:"reply-body",domProps:{innerHTML:e._s(e.body)}}),e._v(" "),n("div",{staticClass:"nested-reply-btn"},[e.signedIn?n("button",{staticClass:"btn btn-link add-nested-reply-btn",on:{click:function(t){e.addNested=!0,e.showLoadMore=!1}}},[e._v("\n          Reply\n        ")]):n("a",{staticClass:"btn btn-link add-nested-reply-btn",attrs:{href:e.redirectToLogin}},[e._v("Reply")]),e._v(" "),e.editing?n("div",{staticClass:"edit-reply"},[n("div",[n("form",{attrs:{action:""},on:{submit:function(t){return t.preventDefault(),e.update(t)}}},[n("div",{staticClass:"form-group"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.editBody,expression:"editBody"}],staticClass:"form-control",attrs:{type:"text","aria-label":"...",id:"bodyedit-"+e.reply.id,placeholder:"Add a comment"},domProps:{value:e.editBody},on:{keyup:e.addReplySuggest,input:function(t){t.target.composing||(e.editBody=t.target.value)}}})]),e._v(" "),n("div",{staticClass:"form-group"},[n("button",{staticClass:"btn btn-primary btn-xs",attrs:{type:"submit"}},[e._v("\n                  Save\n                ")]),e._v(" "),n("button",{staticClass:"btn btn-danger btn-xs",on:{click:function(t){e.editing=!1}}},[e._v("\n                  Cancel\n                ")])])])])]):e._e(),e._v(" "),e.addNested?n("div",{staticClass:"edit-reply"},[n("div",[n("form",{attrs:{action:""},on:{submit:function(t){return t.preventDefault(),e.addNestedReply(t)}}},[n("div",{staticClass:"form-group"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.nestedbody,expression:"nestedbody"}],staticClass:"form-control",attrs:{type:"text","aria-label":"...",id:"addNested-"+e.reply.id,placeholder:"Add a comment"},domProps:{value:e.nestedbody},on:{keyup:e.addNestedReplySuggest,input:function(t){t.target.composing||(e.nestedbody=t.target.value)}}})]),e._v(" "),n("div",{staticClass:"form-group"},[n("button",{staticClass:"btn btn-primary btn-xs",attrs:{type:"submit"}},[e._v("\n                  Add\n                ")]),e._v(" "),n("button",{staticClass:"btn btn-danger btn-xs",on:{click:function(t){e.addNested=!1,e.showLoadMore=!0}}},[e._v("\n                  Cancel\n                ")])])])])]):e._e()]),e._v(" "),e.showLoadMore&&e.replies_count>0?n("div",{staticClass:"more-reply"},[n("button",{staticClass:"btn btn-xs btn-link show-nested-replies-btn",on:{click:e.toggleNestedReplies}},[e.showNested?n("div",[n("span",{staticClass:"glyphicon glyphicon-triangle-top"}),e._v(" Hide Reply\n          ")]):n("div",[n("span",{staticClass:"glyphicon glyphicon-triangle-bottom"}),e._v("\n            "+e._s("View "+e.replies_count+" Reply")+"\n          ")])]),e._v(" "),e._l(e.replies,(function(t,a){return e.showNested?n("NestedReplies",{key:a,attrs:{reply:t}}):e._e()}))],2):e._e()])])])}),[],!1,null,"05d3ea61",null).exports,r={data:function(){return{body:"",completed:!1}},computed:{redirectToLogin:function(){return"/redirect-to?page="+location.pathname}},mounted:function(){$("#body").atwho({at:"@",delay:750,callbacks:{remoteFilter:function(e,t){$.getJSON("/api/users",{name:e},(function(e){t(e)}))}}})},methods:{addReply:function(){var e=this;axios.post(location.pathname+"/replies",{body:this.body}).catch((function(e){flash(e.response.data,"danger")})).then((function(t){var n=t.data;e.body="",e.completed=!0,flash("Your reply has been posted."),e.$emit("created",n),eventBus.$emit("addNewReply",n)}))}}},o=(n("ZHmI"),{props:["thread"],components:{Reply:s,NewReply:Object(i.a)(r,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"add-new-reply"},[n("h3",{staticClass:"comment-heading"},[e._v("What did you think?")]),e._v(" "),e.signedIn?n("div",[n("form",{attrs:{action:""},on:{submit:function(t){return t.preventDefault(),e.addReply(t)}}},[n("div",{staticClass:"input-group"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.body,expression:"body"}],staticClass:"form-control",attrs:{type:"text","aria-label":"...",name:"body",id:"body",placeholder:"Add a comment"},domProps:{value:e.body},on:{input:function(t){t.target.composing||(e.body=t.target.value)}}}),e._v(" "),e._m(0)])])]):n("p",{staticClass:"text-center"},[e._v("\n    Please\n    "),n("a",{attrs:{href:e.redirectToLogin}},[e._v("sign in")]),e._v(" to participate in this discussion.\n  ")])])}),[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"input-group-btn"},[t("button",{staticClass:"btn btn-default",attrs:{type:"submit"}},[this._v("Post")])])}],!1,null,"e944b2ae",null).exports,Paginator:n("EHFx").default},mixins:[{data:function(){return{items:[]}},methods:{add:function(e){this.items.push(e),this.$emit("added")},remove:function(e){this.items.splice(e,1),this.$emit("removed")}}}],data:function(){return{dataSet:!1}},created:function(){var e=this;this.fetch(),eventBus.$on("addNewReply",(function(t){eventBus.$emit("commentAdded-"+e.thread.id)})),eventBus.$on("deleteReply",(function(){eventBus.$emit("commentDeleted-"+e.thread.id)})),eventBus.$on("addNestedReplies-"+this.thread.id,(function(){eventBus.$emit("commentAdded-"+e.thread.id)})),eventBus.$on("deleteNestedReplies-"+this.thread.id,(function(){eventBus.$emit("commentDeleted-"+e.thread.id)}))},methods:{fetch:function(e){axios.get(this.url(e)).then(this.refresh)},url:function(e){if(!e){var t=location.search.match(/page=(\d+)/);e=t?t[1]:1}return"".concat(location.pathname,"/replies?page=").concat(e)},refresh:function(e){var t=e.data;this.dataSet=t,this.items=t.data,window.scrollTo(0,0)}}}),d=Object(i.a)(o,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"panel panel-default"},[e.authorize("isBan")?e._e():n("new-reply",{on:{created:e.add}}),e._v(" "),n("div",{staticClass:"panel-"},[e._l(e.items,(function(t,a){return n("div",{key:t.id},[n("reply",{attrs:{reply:t},on:{deleted:function(t){return e.remove(a)}}})],1)})),e._v(" "),n("paginator",{attrs:{dataSet:e.dataSet},on:{changed:e.fetch}})],2)],1)])}),[],!1,null,null,null);t.default=d.exports},S0md:function(e,t,n){"use strict";var a=n("OP0S");n.n(a).a},W1YS:function(e,t,n){(e.exports=n("I1BE")(!1)).push([e.i,"\n.single-reply[data-v-05d3ea61] {\r\n  margin: 5px;\n}\n.comment-body[data-v-05d3ea61] {\r\n  resize: vertical !important;\n}\n.reply_created_at[data-v-05d3ea61] {\r\n  color: #92959e;\r\n  font-size: 12px;\r\n  font-style: italic;\r\n  margin-right: 10px;\n}\n.reply-body[data-v-05d3ea61] {\r\n  padding: 0;\r\n  margin-left: 20px;\r\n  margin-top: -8px;\r\n  color: #92959e;\n}\n.nested-reply-btn[data-v-05d3ea61] {\r\n  margin-left: 10px;\n}\n.more-reply[data-v-05d3ea61] {\r\n  margin-left: 20px;\n}\n.add-nested-reply-btn[data-v-05d3ea61] {\r\n  color: #92959e;\n}\n.add-nested-reply-btn[data-v-05d3ea61]:hover {\r\n  color: #92959e;\r\n  text-decoration: none;\n}\n.add-nested-reply-btn[data-v-05d3ea61]:focus {\r\n  outline: none;\r\n  text-decoration: none;\n}\n.reply-edit-delete-btn[data-v-05d3ea61] {\r\n  display: flex;\r\n  justify-content: flex-end;\n}\n.show-nested-replies-btn[data-v-05d3ea61] {\r\n  /* color: black; */\r\n  color: #92959e;\n}\n.show-nested-replies-btn[data-v-05d3ea61]:focus {\r\n  outline: none;\r\n  text-decoration: none;\n}\n.show-nested-replies-btn[data-v-05d3ea61]:hover {\r\n  color: #92959e;\r\n  text-decoration: none;\n}\n.glyphicon-triangle-top[data-v-05d3ea61],\r\n.glyphicon-triangle-bottom[data-v-05d3ea61] {\r\n  margin-right: 5px;\r\n  font-size: 10px;\n}\r\n",""])},ZHmI:function(e,t,n){"use strict";var a=n("mCrN");n.n(a).a},mCrN:function(e,t,n){var a=n("OvF0");"string"==typeof a&&(a=[[e.i,a,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n("aET+")(a,i);a.locals&&(e.exports=a.locals)},"z/Db":function(e,t,n){"use strict";var a=n("Aoi+");n.n(a).a}}]);